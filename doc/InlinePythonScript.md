# Inline Python Script
The inline python script and the simulation executable should be placed in the same location. The script is only read once at the initialization stage and only one script can be loaded in a runtime, so user should put all their functions in one file. `libyt` will then call these Python functions in the runtime.

- [Script Format](#script-format)
- [Distinguish `libyt` Fields and `yt` Fields](#distinguish-libyt-fields-and-yt-fields)
- [Supported `yt` Functionalities](#supported-yt-functionalities)

## Script Format
You should always include the first two line, then move all the other commands into python functions and replace `yt.load()` to `yt.frontends.libyt.libytDataset()`. For example,
```python
# inline script
import yt
yt.enable_parallelism()

def yt_inline():
    ds = yt.frontends.libyt.libytDataset()     # <--> yt.load("Data")
    proj = yt.ProjectionPlot(ds, "density")
    if yt.is_root():
        proj.save()
```
We have borrowed parallel computation ability in `yt`, you can also refer to [Parallel Computation With yt](https://yt-project.org/doc/analyzing/parallel_computation.html#parallel-computation-with-yt).
> :warning: When doing volume rendering, do *not* use `yt.is_root()` when saving outputs. Because this is not a serial process, it requires all ranks to work cooperatively.

## Distinguish `libyt` Fields and `yt` Fields
We use the term *`libyt` fields* for fields loaded or generated by `libyt`. The term *`yt` fields* is for fields defined in `XXXFieldInfo` in each frontends or yt defined intrinsic fields. `libyt` support both of them.

You should distinuguish them when referring to fields in inline Python script.
- Add `frontend` name if you are referring to `libyt` fields. An example of calling `libyt` fields in `gamer` frontend:
  ```python
  def yt_inline():
      ds = yt.frontends.libyt.libytDataset()
      sz = yt.ProjectionPlot(ds, 'z', ("gamer", "velocity_x"), center='c')
      if yt.is_root():
          sz.save()
  ```
  
- An example of calling `yt` fields:
  ```python
  def yt_inline():
      ds = yt.frontends.libyt.libytDataset()
      sz = yt.ProjectionPlot(ds, 'z', "velocity_x", center='c')
      if yt.is_root():
          sz.save()
  ```

## Supported `yt` Functionalities 
|       `yt` Function      | Supported | Notes                                    |
|:------------------------:|:---------:|------------------------------------------|
| `find_max`               | V         |                                          |
| `ProjectionPlot`         | V         |                                          |
| `OffAxisProjectionPlot`  | V         |                                          |
| `SlicePlot`              | V         |                                          |
| `OffAxisSlicePlot`       | V         |                                          |
| `covering_grid`          | V         |                                          |
| 1D `create_profile`      | V         |                                          |
| 2D `create_profile`      | V         |                                          |
| `ProfilePlot`            | V         |                                          |
| `PhasePlot`              | V         |                                          |
| `LinePlot`               | V         |                                          |
| Halo Analysis            |           | Not test yet.                            |
| Isocontours              |           | Not test yet.                            |
| `volume_render`          | V         | Only when MPI size is even will it work. |
| `ParticlePlot`           | X         | Generate false figure.                   |
| `ParticleProjectionPlot` | X         | Generate false figure.                   |
